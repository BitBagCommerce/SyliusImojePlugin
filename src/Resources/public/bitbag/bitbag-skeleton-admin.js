(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function n(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?t(Object(o),!0).forEach((function(t){c(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function o(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(){function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),c(this,"togglePayment",(function(){e.paymentCheckboxes.forEach((function(t){t.closest(".required.field").classList.toggle(e.finalConfig.disabledClass),t.closest(".required.field").classList.contains(e.finalConfig.disabledClass)&&(e.toggleCheckboxes(e.paymentCheckboxes,!1),e.paymentMethodHandler.checked=!1)}))})),c(this,"togglePaymentOff",(function(){e.paymentCheckboxes.forEach((function(t){t.closest(".required.field").classList.toggle(e.finalConfig.disabledClass)})),e.toggleCheckboxes(e.paymentCheckboxes,!1),e.paymentMethodHandler.checked=!1})),c(this,"toggleCheckboxes",(function(e,t){e.forEach((function(e){e.checked=t}))})),c(this,"toggleMarginOff",(function(e){e.forEach((function(e){e.closest(".two.fields").classList.add("bb-pbl-margin-zero")}))})),c(this,"storeDataInSession",(function(){var t=o(e.paymentCheckboxes).reduce((function(e,t){return n(n({},e),{},c({},t.id,t.checked))}),{});window.sessionStorage.setItem("checkboxesState",JSON.stringify(t))})),c(this,"loadDataInSession",(function(){var t=JSON.parse(sessionStorage.getItem("checkboxesState"));t&&(e.paymentMethodHandler.checked=!0,e.paymentCheckboxes.forEach((function(n){n.closest(".required.field").classList.toggle(e.finalConfig.disabledClass),n.checked=!!t[n.id]})))})),c(this,"connectListeners",(function(){e.paymentMethodHandler.addEventListener("change",(function(t){e.paymentMethodHandler.checked&&e.toggleCheckboxes(e.paymentCheckboxes,!0),setTimeout((function(){t.preventDefault(),e.togglePayment()}),50)})),e.saveMethodForm.addEventListener("submit",(function(){e.storeDataInSession()})),e.paymentCheckboxes.forEach((function(t){t.addEventListener("change",(function(){e.handleChildCheckbox(t)}))}))})),this.config=r,this.defaultConfig={paymentCheckboxesClass:".bb-pbl-methods",disabledClass:"bb-payment-disabled"},this.finalConfig=n(n({},this.defaultConfig),r),this.paymentMethodHandler=document.getElementById("sylius_payment_method_gatewayConfig_config_pbl"),this.saveMethodForm=document.querySelector('[name="sylius_payment_method"]'),this.paymentCheckboxes=document.querySelectorAll(this.finalConfig.paymentCheckboxesClass)}var r,s,l;return r=t,(s=[{key:"init",value:function(){if(this.config&&"object"!==e(this.config))throw new Error("BitBag - PaymentMethod - given config is not valid - expected object");this.connectListeners(),this.togglePaymentOff(),this.loadDataInSession()}},{key:"handleChildCheckbox",value:function(){o(this.paymentCheckboxes).some((function(e){return e.checked}))||(this.paymentMethodHandler.checked=!1,this.togglePayment())}}])&&a(r.prototype,s),l&&a(r,l),Object.defineProperty(r,"prototype",{writable:!1}),t}();document.querySelector("#sylius_payment_method_gatewayConfig_config_pbl")&&(new s).init()})();